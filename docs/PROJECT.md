# Captain Clench / 肛铁侠 项目说明

## 项目概述

Captain Clench（肛铁侠）是一个部署在 BSC（Binance Smart Chain）上的 DApp，旨在提醒和激励用户每日进行凯格尔运动，锻炼盆底肌群，增强身体健康。

## 核心机制

### 打卡规则

- 管理员可配置打卡冷却时间（cooldown），默认 24 小时
- 每个地址每次打卡需距离上次打卡至少 cooldown 时间
- 每次打卡必须捐献 UIU 代币到奖池，最低 1 UIU
- UIU 代币价值极低（约 0.00001 美元），不构成用户负担

### Combo 连击机制

- 用户在 `2 × cooldown` 时间内完成下一次打卡，combo 连击 +1
- 超过 `2 × cooldown` 未打卡，combo 重置为 1，开始新的 combo 周期
- 每段 combo 以 `(address, startBlock)` 作为唯一标识
- combo 结束时触发 `ComboEnded` 事件，记录历史数据

### 数据记录

合约记录：
- 每个用户的打卡次数
- 每个用户的捐赠总量
- 每个用户的当前 combo 数和 combo 起始区块
- 打卡次数榜单（前 50 名）
- 捐赠数量榜单（前 50 名）
- Combo 连击榜单（前 50 名，世界纪录模式，同一用户可多次上榜）

### 奖池

- 奖池来源：用户打卡捐赠
- 奖池用途：未来可用于社区激励活动

## 前端设计

### 交互流程

**入口**
1. 用户进入页面，显示「连接钱包」按钮
2. 连接钱包后，读取合约获取用户状态
3. 判断当前状态：
   - 活动未开始 → 显示倒计时
   - 在冷却期内 → 显示冷却倒计时
   - 可以打卡 → 进入训练流程
   - 在 combo 窗口期 → 显示 combo 信息和截止时间

**训练流程**

训练分为 3 个部分，每部分之间间隔 10 秒休整：

1. 慢速训练（10 轮）：收紧 3 秒 → 放松 3 秒
2. 快速训练（15 轮）：收紧 1 秒 → 放松 1 秒
3. 耐力训练（3 轮）：收紧 10 秒 → 放松 10 秒

**打卡**
- 用户完成训练流程后，调用合约进行打卡
- 打卡时输入捐献的 UIU 数量（最低 1 UIU）
- 项目基于用户自觉，不做训练完成度的链上验证

### 页面组件

- 连接钱包按钮
- 训练引导 / 状态显示
- Combo 连击排行榜（前 50）
- 打卡次数排行榜（前 50）
- 捐赠数量排行榜（前 50）
- 个人数据（打卡次数、捐赠总量、当前 combo）

## 代币

### UIU 代币

- 项目使用 UIU 代币作为捐赠货币
- 正式环境使用已存在的 UIU 代币合约
- 测试环境需要部署一个 ERC20 测试代币合约

## 智能合约清单

1. **UUToken.sol** - ERC20 测试代币（仅测试环境使用）
2. **DailyKegel.sol** - 主合约
   - 打卡功能（cooldown 间隔限制）
   - Combo 连击机制
   - 捐赠收集（转入奖池）
   - 用户数据记录（打卡次数、捐赠总量、combo 状态）
   - 三个排行榜维护（combo、打卡次数、捐赠数量，各前 50 名）
   - 管理员功能（设置 cooldown、设置 startTime）

## 设计原则

- 纯自觉机制，无金融博弈设计
- 简洁的用户体验，专注于健康习惯养成
- Combo 机制增加趣味性和用户粘性
